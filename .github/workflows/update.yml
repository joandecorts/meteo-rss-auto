# Elimina el fitxer actual
Remove-Item ".github\workflows\update.yml" -Force

# Crea una versi√≥ simplificada i correcta
@'
name: Update Meteo RSS

on:
  workflow_dispatch:
  schedule:
    - cron: "*/10 * * * *"
  repository_dispatch:
    types: [trigger_update]

jobs:
  update:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
          
      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install requests beautifulsoup4 pytz lxml
        
      - name: Run all scripts
        run: |
          python daily_weather_scraper.py
          python generate_fullscreen_html.py
          python generate_meteo_rss.py
          
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./outputs
          publish_branch: gh-pages
          keep_files: false
'@ | Set-Content -Path ".github\workflows\update.yml" -Encoding UTF8

# Verifica
Get-Content ".github\workflows\update.yml" | Select-Object -First 15

# Puja
git add ".github\workflows\update.yml"
git commit -m "FIX: Correct YAML syntax error in workflow"
git push origin main
