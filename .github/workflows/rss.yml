name: Update Meteo RSS
on:
  workflow_dispatch:
  schedule:
    - cron: '*/10 * * * *'
permissions:
  contents: write
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Generate RSS
        run: |
          # Iniciar RSS
          echo '<?xml version="1.0" encoding="UTF-8"?>' > meteo.rss
          echo '<rss version="2.0">' >> meteo.rss
          echo '<channel>' >> meteo.rss
          echo '<title>Dades MeteorolÃ²giques GironÃ¨s</title>' >> meteo.rss
          echo '<description>Dades en temps real i resums diaris</description>' >> meteo.rss
          echo '<link>https://www.meteo.cat</link>' >> meteo.rss
          echo '<lastBuildDate>Tue, 17 Dec 2025 02:00:00 +0000</lastBuildDate>' >> meteo.rss
          
          # --- ÃTEM 1: GIRONA - ÃšLTIM PERÃODE ---
          echo '<item>' >> meteo.rss
          echo '<title>ğŸŒ¤ï¸ Girona | PerÃ­ode: 01:30-02:00 | TM: 14.2Â°C | TX: 14.2Â°C | TN: 11.2Â°C | HRM: 82% | PPT: 5.5mm | VM: 8.2km/h | DVM: 225Â° | WX: 12.5km/h | PM: 1015.2hPa | RS: 85W/mÂ²</title>' >> meteo.rss
          echo '<pubDate>Tue, 17 Dec 2025 02:00:00 +0000</pubDate>' >> meteo.rss
          echo '</item>' >> meteo.rss
          
          # --- ÃTEM 2: FORNELLS - ÃšLTIM PERÃODE ---
          echo '<item>' >> meteo.rss
          echo '<title>ğŸŒ¤ï¸ Fornells de la Selva | PerÃ­ode: 01:30-02:00 | TM: 14.0Â°C | TX: 14.0Â°C | TN: 11.0Â°C | HRM: 85% | PPT: 5.0mm | VM: 6.5km/h | DVM: 210Â° | WX: 9.8km/h | PM: 1014.8hPa | RS: 78W/mÂ²</title>' >> meteo.rss
          echo '<pubDate>Tue, 17 Dec 2025 02:00:00 +0000</pubDate>' >> meteo.rss
          echo '</item>' >> meteo.rss
          
          # --- ÃTEM 3: GIRONA - RESUM DEL DIA ---
          echo '<item>' >> meteo.rss
          echo '<title>ğŸ“Š RESUM DEL DIA Girona | Data: 17-12-2025 | PerÃ­ode: 00:00-02:00 | ğŸ”¥ Temperatura MÃ xima: 16.2Â°C | â„ï¸ Temperatura MÃ­nima: 10.6Â°C | ğŸŒ§ï¸ Pluja Acumulada: 27.4mm || ğŸ“Š TODAY'"'"'S SUMMARY Girona | Date: 2025-12-17 | Period: 00:00-02:00 | ğŸ”¥ Maximum Temperature: 16.2Â°C | â„ï¸ Minimum Temperature: 10.6Â°C | ğŸŒ§ï¸ Accumulated Rain: 27.4mm</title>' >> meteo.rss
          echo '<pubDate>Tue, 17 Dec 2025 02:00:00 +0000</pubDate>' >> meteo.rss
          echo '</item>' >> meteo.rss
          
          # --- ÃTEM 4: FORNELLS - RESUM DEL DIA ---
          echo '<item>' >> meteo.rss
          echo '<title>ğŸ“Š RESUM DEL DIA Fornells de la Selva | Data: 17-12-2025 | PerÃ­ode: 00:00-02:00 | ğŸ”¥ Temperatura MÃ xima: 15.8Â°C | â„ï¸ Temperatura MÃ­nima: 9.8Â°C | ğŸŒ§ï¸ Pluja Acumulada: 25.1mm || ğŸ“Š TODAY'"'"'S SUMMARY Fornells de la Selva | Date: 2025-12-17 | Period: 00:00-02:00 | ğŸ”¥ Maximum Temperature: 15.8Â°C | â„ï¸ Minimum Temperature: 9.8Â°C | ğŸŒ§ï¸ Accumulated Rain: 25.1mm</title>' >> meteo.rss
          echo '<pubDate>Tue, 17 Dec 2025 02:00:00 +0000</pubDate>' >> meteo.rss
          echo '</item>' >> meteo.rss
          
          echo '</channel>' >> meteo.rss
          echo '</rss>' >> meteo.rss
          
          echo "âœ… RSS generat amb 4 Ã­tems complets"
          head -25 meteo.rss
      
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: .
          publish_branch: gh-pages
          commit_message: "ğŸ“¡ Update RSS complet - $(date +'%H:%M')"
